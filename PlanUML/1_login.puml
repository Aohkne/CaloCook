@startuml Login

actor User as "User/Admin"
boundary "LoginPage" as View #lightblue
participant ":authRoute" as Routes_FE #lightblue
control "authController" as Controller #lightblue
participant ":authService" as Service #lightblue
entity "userModel" as Model #lightblue
database "MongoDB" as MongoDB #yellow

group Login
User -> View: 1.Enter login\n {email/username, password}
activate View

View -> View: 2.Validate input
View -> Routes_FE: 3.POST /api/v1/auth/login
activate Routes_FE

Routes_FE -> Controller: 4.login(req, res)
activate Controller

Controller -> Service: 5.login(data)
activate Service

Service -> Model: 6.findUser(email/username)
activate Model

Model -> MongoDB: 7.Query user
activate MongoDB
MongoDB --> Model: 8.Return user
deactivate MongoDB

Model --> Service: 9.Return result
deactivate Model

alt Login Success
    Service -> Service: 10.Verify password & generate token
    Service --> Controller: 10.1. Return success
    deactivate Service
    
    Controller --> Routes_FE: 10.1.1.Return success {token}
    deactivate Controller
    
    Routes_FE --> View: 10.1.2.Success response
    deactivate Routes_FE
    
    View -> View: 10.1.3.Save token
    View --> User: 10.1.4.Redirect to dashboard
    
else Login Failed
    Service --> Controller: 10.2.Return success
    deactivate Service
    
    Controller --> Routes_FE: 10.2.1. Unauthorized
    deactivate Controller
    
    Routes_FE --> View: 10.2.2.Error response
    deactivate Routes_FE
    
    View --> User: 10.2.3.Show error message
end

deactivate View
end

@enduml