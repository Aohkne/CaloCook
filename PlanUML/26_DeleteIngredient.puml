@startuml DeleteIngredient

actor "Admin" as Admin
boundary "DishDetailPage" as View #lightblue
participant ":ingredientRoute" as Route #lightblue
control "ingredientController" as Controller #lightblue
participant ":ingredientService" as Service #lightblue
entity "ingredientModel" as IngredientModel #lightblue
database "MongoDB" as MongoDB #yellow

group Delete Ingredient - Deactivate

Admin -> View: 1. Click "Delete Ingredient" button
activate Admin
activate View

View -> View: 2. Show confirmation dialog
activate View
deactivate View

opt User cancels
    View --> Admin: 2.1 Cancel deletion (dialog closed)
end

Admin -> View: 3. Confirm deletion
View -> Route: 4. PATCH /api/v1/ingredient/:id/deactivate
activate Route

note right of Route: Soft delete by setting\nisActive = false

Route -> Controller: 5. deactivateIngredient(req, res, next)
activate Controller

Controller -> Service: 6. deactivateIngredient(ingredientId)
activate Service

Service -> IngredientModel: 7. updateIsActive(ingredientId, false)
activate IngredientModel

IngredientModel -> MongoDB: 8. ExecuteQuery()
activate MongoDB
MongoDB --> IngredientModel: 9. Return update result
deactivate MongoDB

IngredientModel --> Service: 10. Return ingredient
deactivate IngredientModel

Service --> Controller: 11. Return deactivated ingredient

Controller --> Route: 12. Send 200 JSON response

Route --> View: 13. Return success response

View --> Admin: 14. Show success message\n& hide ingredient from active list



end

group Alternative: Activate Ingredient (Restore)

Admin -> View: 15. View deactivated ingredients

Admin -> View: 16. Click "Restore Ingredient" button

View -> Route: 17. PATCH /api/v1/ingredient/:id/activate

Route -> Controller: 18. activateIngredient(req, res, next)

Controller -> Service: 19. activateIngredient(ingredientId)

Service -> IngredientModel: 20. updateIsActive(ingredientId, true)
activate IngredientModel
IngredientModel -> MongoDB: 21. ExecuteQuery()
activate MongoDB

MongoDB --> IngredientModel: 22. Return update result
deactivate MongoDB


IngredientModel --> Service: 23. Return activated ingredient
deactivate IngredientModel

Service --> Controller: 24. Return activated ingredient
deactivate Service

Controller --> Route: 25. Send 200 JSON response
deactivate Controller

Route --> View: 26. Return success response
deactivate Route

View --> Admin: 27. Show success message\n& add ingredient back to active list
deactivate View
deactivate Admin
end

@enduml