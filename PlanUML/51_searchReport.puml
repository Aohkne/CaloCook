@startuml SearchReportByDish

actor Admin
boundary "Report Page" as View #lightblue
participant ":reportRoute" as Route #lightblue
control "reportController" as Controller #lightblue
participant ":reportService" as Service #lightblue
entity "reportModel" as Model #lightblue
database "MongoDB" as MongoDB #yellow

group Search Report by Dish Name
Admin -> View: 1. Enter dish name and click "Search"
activate Admin
activate View

View -> Route: 2. GET /api/v1/report/search?dishName={keyword}
activate Route

Route -> Controller: 3. getAllReports(req, res)
activate Controller

Controller -> Service: 4. getAllReports(keyword)
activate Service

alt Empty search field (AF2)
    Service -> Model: 4.1. getAllReports()
    activate Model
    Model -> MongoDB: 4.1.1. Query all reports
    activate MongoDB
    MongoDB --> Model: 4.1.2. Return all reports
    deactivate MongoDB
    Model --> Service: 4.1.3. Return reports
    deactivate Model
else Keyword entered
    Service -> Model: 4.2. getAllReports(keyword)
    activate Model
    Model -> MongoDB: 4.2.1. Execute query (case-insensitive, partial match) [BR1]
    activate MongoDB
    MongoDB --> Model: 4.2.2. Return matching reports
    deactivate MongoDB
    Model --> Service: 4.2.3. Return results
    deactivate Model
end

alt No matching reports (AF1)
    Service --> Controller: 5.1. Return empty result
    Controller --> Route: 5.1.1 Return { "message": "No reports found for this dish" }
    Route --> View: 5.1.2 Show "No reports found for this dish"
    View --> Admin: 5.1.3 Display empty result
else Reports found
    Service --> Controller: 5.2. Return reports
    deactivate Service
    Controller --> Route: 5.2.1 Return success {reports}
    deactivate Controller
    Route --> View: 5.2.2 Render report list
    deactivate Route
    View --> Admin: 5.2.3 Show reports with dish details
    deactivate View
    deactivate Admin
end

end
@enduml
