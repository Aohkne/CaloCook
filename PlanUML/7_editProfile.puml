@startuml EditProfile

actor User
boundary "Profile Page" as View #lightblue
participant ":authRoute" as Route #lightblue
control "authController" as Controller #lightblue
participant ":authService" as Service #lightblue
entity "userModel" as Model #lightblue
database "MongoDB" as MongoDB #yellow

group Edit Profile
User -> View: 1. Click "Edit"
activate View
activate User
User -> View: 2. Edit avatar, gender, height, weight, dob.

View -> View: 3. Validate input
activate View
deactivate View

opt Invalid input
    View --> User: 3.1. Display "Invalid input information"
end

View -> Route: 4. POST /api/v1/auth/profile
activate Route

Route -> Controller: 5. editProfile(req, res)
activate Controller

    Controller -> Service: 6. editProfile(userId, profileData)
    activate Service

    Service -> Model: 7. updateUserById(userId, profileData)
    activate Model

    Model -> MongoDB: 8. ExecuteQuery()
    activate MongoDB
    MongoDB --> Model: 9. Return result
    deactivate MongoDB

    Model --> Service: 10. Return update result
    deactivate Model

alt Invalid Input Failed
    Service --> Controller: 10.1. Return error
    Controller --> Route: 10.1.1 Return error info
    Route --> View: 10.1.2. Show "Update failed"
    View --> User: 10.1.3. Display error message
else Update Success
    Service --> Controller: 10.2. Return updated user
    deactivate Service
    Controller --> Route: 10.2.1. Return success
    deactivate Controller
    Route --> View: 10.2.2. Show success
    deactivate Route
    View --> User: 10.2.3. Display "Updated successfully"
    deactivate View
    deactivate User
end
end
@enduml
